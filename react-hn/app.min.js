!function e(t,n,i){function s(a,o){if(!n[a]){if(!t[a]){var m="function"==typeof require&&require;if(!o&&m)return m(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return s(n?n:e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(e){"use strict";var t=e("react"),n=e("react-router"),i=e("./Comment"),s=e("./Item"),r=e("./TopStories"),a=e("./Updates"),o=e("./UserProfile"),m=n.DefaultRoute,l=n.Link,c=n.NotFoundRoute,u=n.Route,d=n.Routes,p=t.createClass({displayName:"App",render:function(){return t.DOM.div({className:"App"},t.DOM.div({className:"App__header"},t.DOM.img({src:"logo.png",width:"16",height:"16",alt:""})," ",l({to:"news",className:"App__homelink"},"React Hacker News")," ",l({to:"newest"},"new")," | ",l({to:"newcomments"},"comments")),t.DOM.div({className:"App__content"},this.props.activeRouteHandler(null)),t.DOM.div({className:"App__footer"},t.DOM.a({href:"https://github.com/insin/react-hn"},"Source on GitHub")))}}),h=t.createClass({displayName:"NotFound",render:function(){return t.DOM.h2(null,"Not found")}}),f=d({location:"hash"},u({name:"app",path:"/",handler:p},m({handler:r}),c({handler:h}),u({name:"news",path:"news",handler:r}),u({name:"item",path:"item/:id",handler:s}),u({name:"job",path:"job/:id",handler:s}),u({name:"poll",path:"poll/:id",handler:s}),u({name:"story",path:"story/:id",handler:s}),u({name:"comment",path:"comment/:id",handler:i,permalinked:!0}),u({name:"newest",path:"newest",handler:a,type:"links"}),u({name:"newcomments",path:"newcomments",handler:a,type:"comments"}),u({name:"user",path:"user/:id",handler:o})));window.React=t,t.renderComponent(f,document.getElementById("app"))},{"./Comment":2,"./Item":4,"./TopStories":8,"./Updates":10,"./UserProfile":11,react:"react","react-router":"react-router"}],2:[function(e,t){"use strict";var n=e("moment"),i=e("react"),s=e("reactfire"),r=e("react-router"),a=e("./services/HNService"),o=e("./Spinner"),m=e("./utils/buildClassName"),l=e("./utils/setTitle"),c=r.Link,u=r.Navigation,d=i.createClass({displayName:"Comment",mixins:[s,u],getDefaultProps:function(){return{comment:null,level:0,maxCommentId:0,permalinked:!1,permalinkThread:!1,showSpinner:!1,threadStore:null}},getInitialState:function(){return{comment:this.props.comment||{},parent:{type:"comment"},collapsed:!1}},componentWillMount:function(){null===this.props.comment?this.bindAsObject(a.itemRef(this.props.id||this.props.params.id),"comment"):this.fetchParent()},componentWillUpdate:function(e,t){if(this.props.permalinked&&this.state.comment.id!=t.comment.id){if("comment"!=t.comment.type)return void this.replaceWith(t.comment.type,{id:t.comment.id});l("Comment by "+t.comment.by)}},componentDidUpdate:function(e,t){this.shouldUseCommentStore()?t.comment.id||!this.state.comment.id||this.state.comment.deleted?t.comment.id&&!t.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.props.id):this.props.threadStore.commentAdded(this.props.id):this.props.permalinked&&this.state.comment.parent!=t.comment.parent&&this.fetchParent()},componentWillReceiveProps:function(e){this.props.permalinked&&this.props.params.id!=e.params.id&&(this.unbind("comment"),this.bindAsObject(a.itemRef(e.params.id),"comment"))},shouldUseCommentStore:function(){return!this.isInPermalinkThread()&&null===this.props.comment},shouldLinkToParent:function(){return this.props.permalinked||null!==this.props.comment},fetchParent:function(){a.fetchItem(this.state.comment.parent,function(e){this.setState({parent:e})}.bind(this))},isInPermalinkThread:function(){return this.props.permalinked||this.props.permalinkThread},isNew:function(){return this.props.maxCommentId>0&&this.props.id>this.props.maxCommentId},toggleCollapsed:function(e){e.preventDefault(),this.setState({collapsed:!this.state.collapsed})},render:function(){var e=this.props,t=this.state.comment;if(!t.id)return i.DOM.div({className:m("Comment Comment--loading Comment--level"+e.level,{"Comment--new":this.isNew()})},(e.permalinked||e.showSpinner)&&o({size:"20"}),t.error&&i.DOM.p(null,"Error loading comment - this may be because the author has configured a delay."));if("comment"!=t.type)return null;if(t.deleted&&!t.kids)return null;var s=this.shouldLinkToParent(),r=null!==this.props.comment&&"comment"!=this.state.parent.type;return i.DOM.div({className:m("Comment Comment--level"+e.level,{"Comment--collapsed":this.state.collapsed,"Comment--dead":t.dead,"Comment--deleted":t.deleted,"Comment--new":this.isNew()})},i.DOM.div({className:"Comment__content"},t.deleted&&i.DOM.div({className:"Comment__meta"},this.renderCollapseControl()," ","[deleted]"),!t.deleted&&i.DOM.div({className:"Comment__meta"},this.renderCollapseControl()," ",c({to:"user",params:{id:t.by},className:"Comment__user"},t.by)," ",n(1e3*t.time).fromNow(),!e.permalinked&&" | ",!e.permalinked&&c({to:"comment",params:{id:t.id}},"link"),s&&" | ",s&&c({to:this.state.parent.type,params:{id:t.parent}},"parent"),r&&" | on: ",r&&c({to:this.state.parent.type,params:{id:t.parent}},this.state.parent.title),t.dead&&" | [dead]"),!t.deleted&&i.DOM.div({className:"Comment__text"},i.DOM.div({dangerouslySetInnerHTML:{__html:t.text}}))),null===this.props.comment&&t.kids&&i.DOM.div({className:"Comment__kids"},t.kids.map(function(t,n){return d({key:t,id:t,level:e.level+1,showSpinner:e.showSpinner||e.permalinked&&0===n,permalinkThread:e.permalinkThread||e.permalinked,maxCommentId:e.maxCommentId,threadStore:e.threadStore})})))},renderCollapseControl:function(){return i.DOM.span({className:"Comment__collapse",onClick:this.toggleCollapsed,onKeyPress:this.toggleCollapsed,tabIndex:"0"},"[",this.state.collapsed?"+":"–","]")}});t.exports=d},{"./Spinner":7,"./services/HNService":15,"./utils/buildClassName":19,"./utils/setTitle":25,moment:"moment",react:"react","react-router":"react-router",reactfire:"reactfire"}],3:[function(e,t){"use strict";var n=e("react"),i=e("./stores/CommentThreadStore"),s=e("./mixins/ItemMixin"),r=e("./mixins/ListItemMixin"),a=n.createClass({displayName:"DisplayListItem",mixins:[s,r],propTypes:{item:n.PropTypes.object.isRequired},getInitialState:function(){return i.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item)}});t.exports=a},{"./mixins/ItemMixin":12,"./mixins/ListItemMixin":13,"./stores/CommentThreadStore":16,react:"react"}],4:[function(e,t){"use strict";function n(e){return e.fromNow(!0).replace(/^an? /,"")}var i=e("react"),s=e("reactfire"),r=e("./Comment"),a=e("./stores/CommentThreadStore"),o=e("./services/HNService"),m=e("./PollOption"),l=e("./Spinner"),c=e("./mixins/ItemMixin"),u=e("./utils/buildClassName"),d=e("./utils/setTitle"),p=i.createClass({displayName:"Item",mixins:[c,s],getInitialState:function(){return{item:{},lastVisit:null,commentCount:0,maxCommentId:0,newCommentCount:0}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.initThreadStore(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillUpdate:function(e,t){this.state.item.id!=t.item.id&&d(t.item.title)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("item"),this.bindAsObject(o.itemRef(e.params.id),"item"),this.initThreadStore())},initThreadStore:function(){this.threadStore&&this.threadStore.dispose(),this.threadStore=new a(this.props.params.id,this.handleCommentsChanged),this.setState(this.threadStore.getInitialState())},handleBeforeUnload:function(){this.threadStore.dispose()},handleCommentsChanged:function(e){this.setState(e)},markAsRead:function(e){e.preventDefault(),this.setState(this.threadStore.markAsRead())},render:function(){var e=this.state,t=e.item;return t.id?i.DOM.div({className:u("Item",{"Item--dead":t.dead})},i.DOM.div({className:"Item__content"},this.renderItemTitle(t),this.renderItemMeta(t,e,"detail",null!==e.lastVisit&&e.newCommentCount>0&&i.DOM.span(null," ","(",i.DOM.em(null,e.newCommentCount," new")," in the last ",n(e.lastVisit),") | ",i.DOM.span({className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),t.text&&i.DOM.div({className:"Item__text"},i.DOM.div({dangerouslySetInnerHTML:{__html:t.text}})),"poll"==t.type&&i.DOM.div({className:"Item__poll"},t.parts.map(function(e){return m({key:e,id:e})}))),t.kids&&i.DOM.div({className:"Item__kids"},t.kids.map(function(t,n){return r({key:t,id:t,level:0,showSpinner:0===n,maxCommentId:e.maxCommentId,threadStore:this.threadStore})}.bind(this)))):i.DOM.div({className:"Item Item--loading"},l({size:"20"}))}});t.exports=p},{"./Comment":2,"./PollOption":6,"./Spinner":7,"./mixins/ItemMixin":12,"./services/HNService":15,"./stores/CommentThreadStore":16,"./utils/buildClassName":19,"./utils/setTitle":25,react:"react",reactfire:"reactfire"}],5:[function(e,t){"use strict";var n=e("react"),i=e("react-router"),s=i.Link,r=n.createClass({displayName:"Paginator",render:function(){return 1!=this.props.page||this.props.hasNext?n.DOM.div({className:"Paginator"},this.props.page>1&&n.DOM.span({className:"Paginator__prev"},s({to:this.props.route,query:{page:this.props.page-1}},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&n.DOM.span({className:"Paginator__next"},s({to:this.props.route,query:{page:this.props.page+1}},"More"))):null}});t.exports=r},{react:"react","react-router":"react-router"}],6:[function(e,t){"use strict";var n=e("react"),i=e("reactfire"),s=e("./services/HNService"),r=e("./Spinner"),a=e("./utils/pluralise"),o=n.createClass({displayName:"PollOption",mixins:[i],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(s.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?n.DOM.div({className:"PollOption"},n.DOM.div({className:"PollOption__text"},e.text),n.DOM.div({className:"PollOption__score"},e.score," point",a(e.score))):n.DOM.div({className:"PollOption PollOption--loading"},r({size:"20"}))}});t.exports=o},{"./Spinner":7,"./services/HNService":15,"./utils/pluralise":24,react:"react",reactfire:"reactfire"}],7:[function(e,t){"use strict";var n=e("react"),i=n.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return n.DOM.div({className:"Spinner",style:{width:3*(this.props.size+this.props.spacing)+"px"}},n.DOM.div({className:"bounce1",style:t}),n.DOM.div({className:"bounce2",style:t}),n.DOM.div({className:"bounce3",style:t}))}});t.exports=i},{react:"react"}],8:[function(e,t){"use strict";var n=e("react"),i=e("reactfire"),s=e("./services/HNService"),r=e("./stores/TopStore"),a=e("./mixins/PageNumberMixin"),o=e("./Paginator"),m=e("./Spinner"),l=e("./TopStoryListItem"),c=e("./utils/constants"),u=e("./utils/pageCalc"),d=e("./utils/setTitle"),p=c.ITEMS_PER_PAGE,h=c.TOP_STORIES,f=n.createClass({displayName:"TopStories",mixins:[a,i],getInitialState:function(){return{items:r.getPageCache(this.getPageNumber()),itemIds:[]}},componentWillMount:function(){this.bindAsObject(s.topStoriesRef(),"itemIds"),d(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){r.saveSession(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillReceiveProps:function(e){this.props.query.page!=e.query.page&&this.setState({items:r.getPageCache(this.getPageNumber(e.query.page))})},handleBeforeUnload:function(){r.saveSession()},render:function(){var e=u(this.getPageNumber(),p,h);if(0===this.state.itemIds.length&&0===this.state.items.length){for(var t=[],i=e.startIndex;i<e.endIndex;i++)t.push(n.DOM.li({className:"ListItem ListItem--loading"},m(null)));return n.DOM.div({className:"Items Items--loading"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},t),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))}return n.DOM.div({className:"Items"},n.DOM.ol({className:"Items__list",start:e.startIndex+1},this.renderItems(e.startIndex,e.endIndex)),o({route:"news",page:e.pageNum,hasNext:e.hasNext}))},renderItems:function(e,t){for(var n=[],i=e,s=0;t>i;i++,s++){var r=this.state.items[s],a=this.state.itemIds[i];n.push(a?l({key:a,id:a,topIndex:i,cachedItem:r}):l({cachedItem:r}))}return n}});t.exports=f},{"./Paginator":5,"./Spinner":7,"./TopStoryListItem":9,"./mixins/PageNumberMixin":14,"./services/HNService":15,"./stores/TopStore":17,"./utils/constants":21,"./utils/pageCalc":23,"./utils/setTitle":25,react:"react",reactfire:"reactfire"}],9:[function(e,t){"use strict";var n=e("react"),i=e("reactfire"),s=e("./stores/CommentThreadStore"),r=e("./services/HNService"),a=e("./stores/TopStore"),o=e("./mixins/ItemMixin"),m=e("./mixins/ListItemMixin"),l=e("./Spinner"),c=n.createClass({displayName:"TopStoryListItem",mixins:[o,m,i],propTypes:{id:n.PropTypes.number,cachedItem:n.PropTypes.object,topIndex:n.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,topIndex:null}},getInitialState:function(){return{item:this.props.cachedItem||{},lastVisit:null,commentCount:null,maxCommentId:null}},componentWillMount:function(){null!==this.props.id?this.initLiveItem():this.state.item.id&&this.setState(s.loadState(this.state.item.id))},componentWillReceiveProps:function(e){null===this.props.id&&null!==e.id&&this.initLiveItem()},componentWillUpdate:function(e,t){this.state.item!==t.item&&a.setItem(this.props.topIndex,t.item)},initLiveItem:function(){this.bindAsObject(r.itemRef(this.props.id),"item"),this.setState(s.loadState(this.props.id))},render:function(){var e=this.state.item;return e.id?this.renderListItem(e):n.DOM.li({className:"ListItem ListItem--loading"},l(null))}});t.exports=c},{"./Spinner":7,"./mixins/ItemMixin":12,"./mixins/ListItemMixin":13,"./services/HNService":15,"./stores/CommentThreadStore":16,"./stores/TopStore":17,react:"react",reactfire:"reactfire"}],10:[function(e,t){"use strict";var n=e("react"),i=e("./stores/UpdatesStore"),s=e("./DisplayListItem"),r=e("./Comment"),a=e("./Paginator"),o=e("./Spinner"),m=e("./mixins/PageNumberMixin"),l=e("./utils/pageCalc"),c=e("./utils/setTitle"),u=30,d=n.createClass({displayName:"Updates",mixins:[m],getInitialState:function(){return i.getCache()},componentWillMount:function(){this.setTitle(this.props.type),i.start(),i.on("updates",this.handleUpdates)},componentWillUnmount:function(){i.off("updates",this.handleUpdates),i.stop()},componentWillReceiveProps:function(e){this.props.type!=e.type&&this.setTitle(e.type)},setTitle:function(e){c("New "+("comments"==e?"Comments":"Links"))},handleUpdates:function(e){return this.isMounted()?void this.setState(e):console.warn("Skipping update of "+this.props.type+" as the Updates component is not mounted")},render:function(){var e="comments"==this.props.type?this.state.comments:this.state.stories;if(0===e.length)return n.DOM.div({className:"Updates Updates--loading"},o({size:"20"}));var t=l(this.getPageNumber(),u,e.length),i=1==t.pageNum&&n.DOM.p({className:"Updates__notice"},"This view will currently only update while you have it open - this will be configurable sometime…");return"comments"==this.props.type?n.DOM.div({className:"Updates Comments"},i,e.slice(t.startIndex,t.endIndex).map(function(e){return r({key:e.id,id:e.id,comment:e})}),a({route:"newcomments",page:t.pageNum,hasNext:t.hasNext})):n.DOM.div({className:"Updates Items"},i,n.DOM.ol({className:"Items__list",start:t.startIndex+1},e.slice(t.startIndex,t.endIndex).map(function(e){return s({key:e.id,item:e})})),a({route:"newest",page:t.pageNum,hasNext:t.hasNext}))}});t.exports=d},{"./Comment":2,"./DisplayListItem":3,"./Paginator":5,"./Spinner":7,"./mixins/PageNumberMixin":14,"./stores/UpdatesStore":18,"./utils/pageCalc":23,"./utils/setTitle":25,react:"react"}],11:[function(e,t){"use strict";var n=e("moment"),i=e("react"),s=e("reactfire"),r=e("./services/HNService"),a=e("./Spinner"),o=e("./utils/setTitle"),m=i.createClass({displayName:"UserProfile",mixins:[s],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(r.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!=t.user.id&&o("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!=e.params.id&&(this.unbind("user"),this.bindAsObject(r.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return i.DOM.div({className:"UserProfile UserProfile--loading"},i.DOM.h4(null,this.props.params.id),a({size:"20"}));var t=n(1e3*e.created);return i.DOM.div({className:"UserProfile"},i.DOM.h4(null,e.id),i.DOM.dl(null,i.DOM.dt(null,"Created"),i.DOM.dd(null,t.fromNow()," (",t.format("LL"),")"),i.DOM.dt(null,"Karma"),i.DOM.dd(null,e.karma),i.DOM.dt(null,"Delay"),i.DOM.dd(null,e.delay),e.about&&i.DOM.dt(null,"About"),e.about&&i.DOM.dd(null,i.DOM.div({className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.exports=m},{"./Spinner":7,"./services/HNService":15,"./utils/setTitle":25,moment:"moment",react:"react",reactfire:"reactfire"}],12:[function(e,t){"use strict";var n=e("react"),i=e("moment"),s=e("react-router"),r=e("../utils/pluralise"),a=s.Link,o=function(){var e=document.createElement("a");return function(t){e.href=t;var n=e.hostname.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}}(),m={renderItemMeta:function(e,t,s,o){var m=i(1e3*e.time),l="job"!=e.type,c=e.kids&&e.kids.length>0?"comments":"discuss";return t.commentCount>0&&(c=t.commentCount+" comment"+r(t.commentCount)),"list"==s&&(c=a({to:e.type,params:{id:e.id}},c)),n.DOM.div({className:"Item__meta"},l&&n.DOM.span({className:"Item__score"},e.score," point",r(e.score))," ",l&&n.DOM.span({className:"Item__by"},"by ",a({to:"user",params:{id:e.by}},e.by))," ",n.DOM.span({className:"Item__time"},m.fromNow()),l&&" | ",l&&c,o)},renderItemTitle:function(e){var t,i=!!e.url;return t=e.dead?"[dead] "+e.title:i?n.DOM.a({href:e.url},e.title):a({to:e.type,params:{id:e.id}},e.title),n.DOM.div({className:"Item__title"},t,i&&" ",i&&n.DOM.span({className:"Item__host"},"(",o(e.url),")"))}};t.exports=m},{"../utils/pluralise":24,moment:"moment",react:"react","react-router":"react-router"}],13:[function(e,t){"use strict";function n(e,t){return e?e.filter(t):[]}var i=e("react"),s=e("react-router"),r=e("../utils/buildClassName"),a=e("../utils/pluralise"),o=s.Link,m={getNewThreadCount:function(e){return null===this.state.lastVisit?0:n(e.kids,function(e){return e>this.state.maxCommentId}.bind(this)).length},renderListItem:function(e){if(e.deleted)return null;var t=this.state,n=this.getNewThreadCount(e),s=n>0;return i.DOM.li({className:r("ListItem",{"ListItem--dead":e.dead})},this.renderItemTitle(e),this.renderItemMeta(e,t,"list",null!==t.lastVisit&&i.DOM.span(null," ","(",t.lastVisit.fromNow(),")",s&&" | ",s&&o({to:"item",params:{id:e.id}},i.DOM.em(null,n," new thread",a(n))))))}};t.exports=m},{"../utils/buildClassName":19,"../utils/pluralise":24,react:"react","react-router":"react-router"}],14:[function(e,t){"use strict";var n={getPageNumber:function(e){return"undefined"==typeof e&&(e=this.props.query.page),e&&/^\d+$/.test(e)?Math.max(1,Number(e)):1}};t.exports=n},{}],15:[function(e,t){"use strict";function n(e,t){r(e).once("value",function(e){t(e.val())})}function i(e,t){function i(n){s.push(n),s.length>=e.length&&t(s)}var s=[];e.forEach(function(e){n(e,i)})}function s(){return l.child("topstories")}function r(e){return l.child("item/"+e)}function a(e){return l.child("user/"+e)}function o(){return l.child("updates/items")}var m=e("firebase"),l=new m("https://hacker-news.firebaseio.com/v0");t.exports={fetchItem:n,fetchItems:i,topStoriesRef:s,itemRef:r,userRef:a,updatesRef:o}},{firebase:"firebase"}],16:[function(e,t){"use strict";function n(e){var t=a.get(e+m,null);return{lastVisit:null!==t?s(Number(t)):null,commentCount:Number(a.get(e+o,"0")),maxCommentId:Number(a.get(e+l,"0"))}}function i(e,t){function i(){a.set(e+o,f),a.set(e+m,Date.now()),a.set(e+l,N)}function c(){return g}function u(e){f++,x>0&&e>x&&(v++,I[e]=!0),e>N&&(N=e),S(),C&&M()}function d(e){f--,"undefined"!=typeof I[e]&&(v--,delete I[e]),S()}function p(){return v=0,x=N,I={},i(),{lastVisit:s(Date.now()),maxCommentId:N,newCommentCount:v}}function h(){S.cancel(),C&&M.cancel(),i()}var f=0,v=0,I={},N=0,g=n(e),x=g.maxCommentId,C=null===g.lastVisit,S=r(function(){t({commentCount:f,newCommentCount:v})},100),M=null;return C&&(M=r(function(){x=N,C=!1,t({lastVisit:s(Date.now()),maxCommentId:x}),M=null},5e3)),C&&M(),{getInitialState:c,markAsRead:p,commentAdded:u,commentDeleted:d,dispose:h,_getVars:function(){return{commentCount:f,newCommentCount:v,newCommentIds:I,maxCommentId:N,prevMaxCommentId:x,isFirstVisit:C}}}}var s=e("moment"),r=e("../utils/cancellableDebounce"),a=e("../utils/storage"),o=":cc",m=":lv",l=":mc";i.loadState=n,t.exports=i},{"../utils/cancellableDebounce":20,"../utils/storage":26,moment:"moment"}],17:[function(e,t){"use strict";var n=e("../utils/constants"),i=e("../utils/pageCalc"),s=n.ITEMS_PER_PAGE,r=n.TOP_STORIES,a=null,o={setItem:function(e,t){a[e]=t},getPageCache:function(e){if(null===a){var t=sessionStorage.topstories;a=t?JSON.parse(t):[]}var n=i(e,s,r);return a.slice(n.startIndex,n.endIndex)},saveSession:function(){sessionStorage.topstories=JSON.stringify(a)}};t.exports=o},{"../utils/constants":21,"../utils/pageCalc":23}],18:[function(e,t){"use strict";function n(e,t){return t.time-e.time}function i(e,t){var n=Object.keys(e).map(function(t){return e[t]});return n.sort(t),n}function s(e){var t=i(e,n);return t.splice(c,Math.max(0,t.length-c)).forEach(function(t){delete e[t.id]}),t}function r(e){for(var t=0,n=e.length;n>t;t++){var i=e[t];i.deleted||"undefined"==typeof i.error&&"undefined"!=typeof v[i.type]&&("comment"==i.type?d[i.id]=i:p[i.id]=i)}h=s(d),f=s(p),I.emit("updates",I.getCache())}var a=e("events").EventEmitter,o=e("../services/HNService"),m=e("../utils/constants"),l=e("../utils/extend"),c=m.UPDATE_CACHE_SIZE,u=null,d={},p={},h=[],f=[],v={comment:!0,job:!0,poll:!0,story:!0},I=l(new a,{start:function(){null===u&&(u=o.updatesRef(),u.on("value",function(e){o.fetchItems(e.val(),r)}))},getCache:function(){return{comments:h,stories:f}},stop:function(){u.off(),u=null}});I.off=I.removeListener,t.exports=I},{"../services/HNService":15,"../utils/constants":21,"../utils/extend":22,events:"events"}],19:[function(e,t){"use strict";function n(e,t){var n=[];"undefined"==typeof t?t=e:n.push(e);for(var i=Object.keys(t),s=0,r=i.length;r>s;s++)t[i[s]]&&n.push(i[s]);return n.join(" ")}t.exports=n},{}],20:[function(e,t){"use strict";function n(e,t,n){var i,s,r,a,o,m=function(){var l=Date.now()-a;t>l&&l>0?i=setTimeout(m,t-l):(i=null,n||(o=e.apply(r,s),i||(r=s=null)))},l=function(){r=this,s=arguments,a=Date.now();var l=n&&!i;return i||(i=setTimeout(m,t)),l&&(o=e.apply(r,s),r=s=null),o};return l.cancel=function(){i&&clearTimeout(i)},l}t.exports=n},{}],21:[function(e,t){"use strict";t.exports={ITEMS_PER_PAGE:30,SITE_TITLE:"React Hacker News",TOP_STORIES:100,UPDATE_CACHE_SIZE:200}},{}],22:[function(e,t){"use strict";function n(e,t,n){for(var i=Object.keys(t),s=0,r=i.length;r>s;s++)e[i[s]]=t[i[s]];if(n)for(i=Object.keys(n),s=0,r=i.length;r>s;s++)e[i[s]]=n[i[s]];return e}t.exports=n},{}],23:[function(e,t){"use strict";function n(e,t,n){var i=(e-1)*t,s=Math.min(n,i+t),r=n-1>s;return{pageNum:e,startIndex:i,endIndex:s,hasNext:r}}t.exports=n},{}],24:[function(e,t){"use strict";function n(e){return 1==e?"":"s"}t.exports=n},{}],25:[function(e,t){"use strict";function n(e){document.title=e?e+" | "+i:i}var i=e("./constants").SITE_TITLE;t.exports=n},{"./constants":21}],26:[function(e,t){"use strict";t.exports={get:function(e,t){var n=localStorage[e];return"undefined"!=typeof n?n:t},set:function(e,t){localStorage[e]=t}}},{}]},{},[1]);