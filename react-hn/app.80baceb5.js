(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{100:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(60).default,o=n(15).default,r=n(9).default,l=n(59).default,m=n(34).default,d=i.createClass({displayName:"Comment",mixins:[l,s],propTypes:{id:i.PropTypes.number.isRequired,level:i.PropTypes.number.isRequired,loadingSpinner:i.PropTypes.bool,threadStore:i.PropTypes.instanceOf(a).isRequired},getDefaultProps:function(){return{loadingSpinner:!1}},getInitialState:function(){return{comment:{}}},componentWillMount:function(){this.bindFirebaseRef()},componentWillUnmount:function(){this.clearDelayTimeout()},componentDidUpdate:function(e,t){if(this.state.comment)if(t.comment&&t.comment.id){if(!t.comment.deleted&&this.state.comment.deleted&&this.props.threadStore.commentDeleted(this.state.comment),!t.comment.dead&&this.state.comment.dead)this.props.threadStore.commentDied(this.state.comment);else if(t.comment!==this.state.comment&&this.props.threadStore.loading){var n=this.state.comment.kids?this.state.comment.kids.length:0,i=t.comment.kids?t.comment.kids.length:0;this.props.threadStore.adjustExpectedComments(n-i)}}else this.state.comment.id&&(t.comment&&t.comment.delayed&&this.clearDelayTimeout(),this.props.threadStore.commentAdded(this.state.comment)),t.comment&&!t.comment.delayed&&this.state.comment.delayed&&this.props.threadStore.commentDelayed(this.props.id);else this.props.threadStore.adjustExpectedComments(-1)},bindFirebaseRef:function(){this.bindAsObject(o.itemRef(this.props.id),"comment",this.handleFirebaseRefCancelled),this.timeout&&(this.timeout=null)},handleFirebaseRefCancelled:function(e){this.unbind("comment"),this.timeout=setTimeout(this.bindFirebaseRef,3e4),this.state.comment&&!this.state.comment.delayed&&(this.state.comment.delayed=!0,this.forceUpdate())},clearDelayTimeout:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},toggleCollapse:function(e){e.preventDefault(),this.props.threadStore.toggleCollapse(this.state.comment.id)},render:function(){var e=this.state.comment,t=this.props;if(!e)return this.renderError(e,{id:this.props.id,className:"Comment Comment--error Comment--level"+t.level});if(!e.id)return this.renderCommentLoading(e);if(e.dead&&!r.showDead)return null;if(e.deleted)return r.showDeleted?this.renderCommentDeleted(e,{className:"Comment Comment--deleted Comment--level"+t.level}):null;var n=t.threadStore.isNew[e.id],s=!!t.threadStore.isCollapsed[e.id],a=s&&t.threadStore.getChildCounts(e);s&&n&&(a.newComments=0);var o=m("Comment Comment--level"+t.level,{"Comment--collapsed":s,"Comment--dead":e.dead,"Comment--new":n});return i.createElement("div",{className:o},i.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{collapsible:!0,collapsed:s,link:!0,childCounts:a}),this.renderCommentText(e,{replyLink:!0})),e.kids&&i.createElement("div",{className:"Comment__kids"},e.kids.map(function(e){return i.createElement(d,{key:e,id:e,level:t.level+1,loadingSpinner:t.loadingSpinner,threadStore:t.threadStore})})))}});t.default=d},103:function(e,t,n){"use strict";n.r(t),function(e){var i=n(15).default,s=n(44).default,a=n(43).default,o={},r={};function l(e,t,n){for(var i=e.id,s=e.parent;o[s]||r[s];){if(n.itemCount++,n.cacheHits++,r[s])return 1===n.itemCount&&(n.parent=r[s]),n.op=r[s],void t(n);o[s]&&(1===n.itemCount&&(n.parent={id:s,type:"comment"}),i=s,s=o[s])}m.getItem(s,function(e){n.itemCount++,o[i]=s,"comment"===e.type&&(o[e.id]=e.parent),function(e,t,n){1===n.itemCount&&(n.parent=e);"comment"!==e.type?(n.op=e,r[e.id]={id:e.id,type:e.type,title:e.title},t(n)):l(e,t,n)}(e,t,n)},n)}var m={getItem:function(t,n,s){var a=this.getCachedItem(t);a?(s&&s.cacheHits++,e(n,a)):i.fetchItem(t,n)},getCachedItem:function(e){return s.getItem(e)||a.getItem(e)||null},getCachedStory:function(e){return s.getItem(e)||a.getStory(e)||null},fetchCommentAncestors:function(t,n){var i=Date.now(),s={itemCount:0,cacheHits:0};l(t,function(){s.timeTaken=Date.now()-i,e(n,s)},s)}};t.default=m}.call(this,n(102).setImmediate)},104:function(e,t,n){"use strict";n.r(t),t.default={get:function(e,t){var n=window.localStorage[e];return void 0!==n?n:t},set:function(e,t){window.localStorage[e]=t}}},15:function(e,t,n){"use strict";n.r(t);var i=n(105);n(173);i.initializeApp({databaseURL:"https://hacker-news.firebaseio.com"});var s=i.database().ref("/v0");function a(e,t){o(e).once("value",function(e){t(e.val())})}function o(e){return s.child("item/"+e)}t.default={fetchItem:a,fetchItems:function(e,t){var n=[];function i(i){n.push(i),n.length>=e.length&&t(n)}e.forEach(function(e){a(e,i)})},storiesRef:function(e){return s.child(e)},itemRef:o,userRef:function(e){return s.child("user/"+e)},updatesRef:function(){return s.child("updates/items")}}},158:function(e,t,n){"use strict";n.r(t);var i=n(0),s=i.createElement("h2",null,"Not found"),a=i.createClass({displayName:"NotFound",render:function(){return s}});t.default=a},159:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(46).default,o=n(15).default,r=n(22).default,l=n(33).default,m=i.createElement(r,{size:"20"}),d=i.createElement("dt",null,"Created"),c=i.createElement("dt",null,"Karma"),u=i.createElement("dt",null,"Delay"),h=i.createElement("dt",null,"About"),p=i.createClass({displayName:"UserProfile",mixins:[s],getInitialState:function(){return{user:{}}},componentWillMount:function(){this.bindAsObject(o.userRef(this.props.params.id),"user")},componentWillUpdate:function(e,t){this.state.user.id!==t.user.id&&l("Profile: "+t.user.id)},componentWillReceiveProps:function(e){this.props.params.id!==e.params.id&&(this.unbind("user"),this.bindAsObject(o.userRef(e.params.id),"user"))},render:function(){var e=this.state.user;if(!e.id)return i.createElement("div",{className:"UserProfile UserProfile--loading"},i.createElement("h4",null,this.props.params.id),m);var t=new Date(1e3*e.created);return i.createElement("div",{className:"UserProfile"},i.createElement("h4",null,e.id),i.createElement("dl",null,d,i.createElement("dd",null,i.createElement(a,{date:t})," (",t.toDateString(),")"),c,i.createElement("dd",null,e.karma),u,i.createElement("dd",null,e.delay),e.about&&h,e.about&&i.createElement("dd",null,i.createElement("div",{className:"UserProfile__about",dangerouslySetInnerHTML:{__html:e.about}}))))}});t.default=p},160:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(139),o=n(60).default,r=n(15).default,l=n(9).default,m=n(43).default,d=n(100).default,c=n(59).default,u=n(34).default,h=n(33).default,p=i.createClass({displayName:"PermalinkedComment",mixins:[c,s],getDefaultProps:function(){return{level:0,loadingSpinner:!0}},getInitialState:function(){return{comment:m.getComment(this.props.params.id)||{},parent:{type:"comment"},op:{}}},componentWillMount:function(){this.bindAsObject(r.itemRef(this.props.params.id),"comment"),this.state.comment.id&&this.commentLoaded(this.state.comment)},componentWillReceiveProps:function(e){if(e.params.id!==this.props.params.id){var t=m.getComment(e.params.id);t&&(this.commentLoaded(t),this.setState({comment:t})),this.unbind("comment"),this.bindAsObject(r.itemRef(e.params.id),"comment")}},componentWillUpdate:function(e,t){if(t.comment&&this.state.comment.id!==t.comment.id){if(!t.comment.deleted&&"comment"!==t.comment.type)return void this.props.router.replace("/"+t.comment.type+"/"+t.comment.id);this.threadStore&&this.threadStore.itemId===t.comment.id||this.commentLoaded(t.comment)}},commentLoaded:function(e){this.setTitle(e),e.deleted||(this.threadStore=new o(e,this.handleCommentsChanged),this.fetchAncestors(e))},setTitle:function(e){if(e.deleted)return h("Deleted comment");var t="Comment by "+e.by;this.state.op.id&&(t+=" | "+this.state.op.title),h(t)},handleCommentsChanged:function(e){"collapse"===e.type&&this.forceUpdate()},render:function(){var e=this.state.comment;if(!e)return this.renderError(e,{id:this.props.params.id,className:"Comment Comment--level0 Comment--error"});if(!e.id)return this.renderCommentLoading(e);if(e.deleted)return this.renderCommentDeleted(e,{className:"Comment Comment--level0 Comment--deleted"});if("comment"!==e.type)return null;var t=u("PermalinkedComment Comment Comment--level0",{"Comment--dead":e.dead}),n=this.threadStore;return i.createElement("div",{className:t},i.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!==this.state.op.id,op:!!this.state.op.id}),(!e.dead||l.showDead)&&this.renderCommentText(e,{replyLink:!0})),e.kids&&i.createElement("div",{className:"Comment__kids"},e.kids.map(function(e,t){return i.createElement(d,{key:e,id:e,level:0,loadingSpinner:0===t,threadStore:n})})))}});t.default=a(p)},161:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(9).default,a=n(59).default,o=n(34).default,r=i.createClass({displayName:"DisplayComment",mixins:[a],propTypes:{comment:i.PropTypes.object.isRequired},getInitialState:function(){return{op:{},parent:{type:"comment"}}},componentWillMount:function(){this.fetchAncestors(this.props.comment)},render:function(){if(this.props.comment.deleted)return null;if(this.props.comment.dead&&!s.showDead)return null;var e=this.props.comment,t=o("Comment Comment--level0",{"Comment--dead":e.dead});return i.createElement("div",{className:t},i.createElement("div",{className:"Comment__content"},this.renderCommentMeta(e,{link:!0,parent:!!this.state.parent.id&&!!this.state.op.id&&e.parent!==this.state.op.id,op:!!this.state.op.id}),this.renderCommentText(e,{replyLink:!1})))}});t.default=r},162:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(61).default,a=n(58).default,o=n(97).default,r=i.createClass({displayName:"DisplayListItem",mixins:[a,o],propTypes:{item:i.PropTypes.object.isRequired},componentWillMount:function(){this.threadState=s.loadState(this.props.item.id)},render:function(){return this.renderListItem(this.props.item,this.threadState)}});t.default=r},163:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(9).default,a=n(43).default,o=n(162).default,r=n(161).default,l=n(98).default,m=n(22).default,d=n(99).default,c=n(42).default.ITEMS_PER_PAGE,u=n(96).default,h=n(33).default;function p(e){return!e.dead}function f(e){return s.showDead?e:{comments:e.comments.filter(p),stories:e.stories.filter(p)}}var C=i.createElement("div",{className:"Updates Updates--loading"},i.createElement(m,{size:"20"})),g=i.createClass({displayName:"Updates",mixins:[d],getInitialState:function(){return f(a.getUpdates())},componentWillMount:function(){this.setTitle(this.props.type),a.start(),a.on("updates",this.handleUpdates)},componentWillUnmount:function(){a.off("updates",this.handleUpdates),a.stop()},componentWillReceiveProps:function(e){this.props.type!==e.type&&this.setTitle(e.type)},setTitle:function(e){h("New "+("comments"===e?"Comments":"Links"))},handleUpdates:function(e){this.isMounted()&&this.setState(f(e))},render:function(){var e="comments"===this.props.type?this.state.comments:this.state.stories;if(0===e.length)return C;var t=u(this.getPageNumber(),c,e.length);return"comments"===this.props.type?i.createElement("div",{className:"Updates Comments"},e.slice(t.startIndex,t.endIndex).map(function(e){return i.createElement(r,{key:e.id,id:e.id,comment:e})}),i.createElement(l,{route:"newcomments",page:t.pageNum,hasNext:t.hasNext})):i.createElement("div",{className:"Updates Items"},i.createElement("ol",{className:"Items__list",start:t.startIndex+1},e.slice(t.startIndex,t.endIndex).map(function(e){return i.createElement(o,{key:e.id,item:e})})),i.createElement(l,{route:"newest",page:t.pageNum,hasNext:t.hasNext}))}});t.default=g},164:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(61).default,o=n(15).default,r=n(9).default,l=n(44).default,m=n(58).default,d=n(97).default,c=n(22).default,u=i.createElement(c,null),h=i.createClass({displayName:"StoryListItem",mixins:[m,d,s],propTypes:{store:i.PropTypes.instanceOf(l).isRequired,id:i.PropTypes.number,cachedItem:i.PropTypes.object,index:i.PropTypes.number},getDefaultProps:function(){return{id:null,cachedItem:null,index:null}},getInitialState:function(){return{item:this.props.cachedItem||{}}},componentWillMount:function(){null!=this.props.id?this.initLiveItem(this.props):null!=this.props.cachedItem&&(this.threadState=a.loadState(this.state.item.id))},componentWillUnmount:function(){null!=this.props.id&&this.props.store.removeListener(this.props.id,this.updateThreadState)},componentWillReceiveProps:function(e){null==this.props.id&&null!=e.id&&this.initLiveItem(e)},componentWillUpdate:function(e,t){this.state.item!==t.item&&null!=t.item&&this.props.store.itemUpdated(t.item,this.props.index)},initLiveItem:function(e){this.bindAsObject(o.itemRef(e.id),"item"),this.threadState=a.loadState(e.id),this.props.store.addListener(e.id,this.updateThreadState)},updateThreadState:function(){this.threadState=a.loadState(this.props.id),this.forceUpdate()},render:function(){return this.state.item&&this.state.item.id?this.renderListItem(this.state.item,this.threadState):i.createElement("li",{className:"ListItem ListItem--loading",style:{marginBottom:r.listSpacing}},u)}});t.default=h},165:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(44).default,a=n(99).default,o=n(98).default,r=n(22).default,l=n(164).default,m=n(9).default,d=n(42).default.ITEMS_PER_PAGE,c=n(96).default,u=n(33).default,h=i.createElement("div",{className:"Items"}),p=i.createElement("div",{className:"Items"},i.createElement("p",null,"There are no previously read stories to display.")),f=i.createElement(r,null),C=i.createClass({displayName:"Stories",mixins:[a],propTypes:{limit:i.PropTypes.number.isRequired,route:i.PropTypes.string.isRequired,type:i.PropTypes.string.isRequired,title:i.PropTypes.string},getInitialState:function(){return{ids:null,limit:this.props.limit,stories:[]}},componentDidMount:function(){u(this.props.title),this.store=new s(this.props.type),this.store.addListener("update",this.handleUpdate),this.store.start(),this.setState(this.store.getState())},componentWillUnmount:function(){this.store.removeListener("update",this.handleUpdate),this.store.stop(),this.store=null},handleUpdate:function(e){this.isMounted()&&(e.limit=e.ids.length,this.setState(e))},render:function(){var e=c(this.getPageNumber(),d,this.state.limit);if("read"===this.props.type){if(null==this.state.ids)return h;if(0===this.state.ids.length)return p}if(null==this.state.ids){for(var t=[],n=e.startIndex;n<e.endIndex;n++)t.push(i.createElement("li",{key:n,className:"ListItem ListItem--loading",style:{marginBottom:m.listSpacing}},f));return i.createElement("div",{className:"Items Items--loading"},i.createElement("ol",{className:"Items__list",start:e.startIndex+1},t),i.createElement(o,{route:this.props.route,page:e.pageNum,hasNext:e.hasNext}))}return i.createElement("div",{className:"Items"},i.createElement("ol",{className:"Items__list",start:e.startIndex+1},this.renderItems(e.startIndex,e.endIndex)),i.createElement(o,{route:this.props.route,page:e.pageNum,hasNext:e.hasNext}))},renderItems:function(e,t){for(var n=[],s=e;s<t;s++){var a=this.state.stories[s],o=this.state.ids[s];o?n.push(i.createElement(l,{key:o,id:o,index:s,cachedItem:a,store:this.store})):n.push(i.createElement(l,{key:s,cachedItem:a,store:this.store}))}return n}});t.default=C},166:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(9).default,a=i.createElement("p",null,"Automatically collapse comment threads without new comments on page load."),o=i.createElement("p",null,'Show "reply" links to Hacker News'),r=i.createElement("p",null,"Show items flagged as dead."),l=i.createElement("p",null,"Show comments flagged as deleted in threads."),m=i.createElement("td",null,i.createElement("label",{htmlFor:"titleFontSize"},"title font size:")),d=i.createElement("td",null,i.createElement("label",{htmlFor:"listSpacing"},"list spacing:")),c=i.createClass({displayName:"Settings",componentDidMount:function(){this.refs.container.focus()},onChange:function(e){var t=e.target;"checkbox"===t.type?s[t.name]=t.checked:"number"===t.type&&t.value&&(s[t.name]=t.value),this.forceUpdate(),s.save()},onClick:function(e){e.stopPropagation()},render:function(){return i.createElement("div",{ref:"container",className:"Settings",tabIndex:"-1",onClick:this.onClick},i.createElement("form",{onChange:this.onChange},i.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},i.createElement("label",{htmlFor:"autoCollapse"},i.createElement("input",{type:"checkbox",name:"autoCollapse",id:"autoCollapse",checked:s.autoCollapse})," auto collapse"),a),i.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},i.createElement("label",{htmlFor:"replyLinks"},i.createElement("input",{type:"checkbox",name:"replyLinks",id:"replyLinks",checked:s.replyLinks})," show reply links"),o),i.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},i.createElement("label",{htmlFor:"showDead"},i.createElement("input",{type:"checkbox",name:"showDead",id:"showDead",checked:s.showDead})," show dead"),r),i.createElement("div",{className:"Settings__setting Settings__setting--checkbox"},i.createElement("label",{htmlFor:"showDeleted"},i.createElement("input",{type:"checkbox",name:"showDeleted",id:"showDeleted",checked:s.showDeleted})," show deleted"),l),i.createElement("div",{className:"Settings__setting"},i.createElement("table",null,i.createElement("tbody",null,i.createElement("tr",null,m,i.createElement("td",null,i.createElement("input",{type:"number",min:"14",step:"1",name:"titleFontSize",id:"titleFontSize",value:s.titleFontSize}))),i.createElement("tr",null,d,i.createElement("td",null,i.createElement("input",{type:"number",min:"0",name:"listSpacing",id:"listSpacing",value:s.listSpacing}))))))))}});t.default=c},167:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(23),a=n(166).default,o=n(44).default,r=n(43).default,l=n(9).default,m=i.createElement(s,{to:"/news",className:"App__homelinkicon"},i.createElement("img",{src:"img/logo.png",width:"16",height:"16",alt:""})),d=i.createElement(s,{to:"/news",activeClassName:"active",className:"App__homelink"},"React HN"),c=i.createElement(s,{to:"/newest",activeClassName:"active"},"new"),u=i.createElement(s,{to:"/newcomments",activeClassName:"active"},"comments"),h=i.createElement(s,{to:"/show",activeClassName:"active"},"show"),p=i.createElement(s,{to:"/ask",activeClassName:"active"},"ask"),f=i.createElement(s,{to:"/jobs",activeClassName:"active"},"jobs"),C=i.createElement(s,{to:"/read",activeClassName:"active"},"read"),g=i.createElement(a,{key:"settings"}),v=i.createElement("a",{href:"https://github.com/insin/react-hn"},"insin/react-hn"),E=i.createClass({displayName:"App",getInitialState:function(){return{showSettings:!1}},componentWillMount:function(){l.load(),o.loadSession(),r.loadSession(),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},handleBeforeUnload:function(){o.saveSession(),r.saveSession()},toggleSettings:function(e){e.preventDefault(),this.setState({showSettings:!this.state.showSettings})},render:function(){return i.createElement("div",{className:"App",onClick:this.state.showSettings&&this.toggleSettings},i.createElement("div",{className:"App__wrap"},i.createElement("div",{className:"App__header"},m," ",d," ",c," | ",u," "," | ",h," | ",p," | ",f," | ",C,i.createElement("a",{className:"App__settings",tabIndex:"0",onClick:this.toggleSettings,onKeyPress:this.toggleSettings},this.state.showSettings?"hide settings":"settings"),this.state.showSettings&&g),i.createElement("div",{className:"App__content"},this.props.children),i.createElement("div",{className:"App__footer"},"react-hn v1.7.0 | ",v)))}});t.default=E},171:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(15).default,o=n(22).default,r=n(45).default,l=i.createElement("div",{className:"PollOption PollOption--loading"},i.createElement(o,{size:"20"})),m=i.createClass({displayName:"PollOption",mixins:[s],getInitialState:function(){return{pollopt:{}}},componentWillMount:function(){this.bindAsObject(a.itemRef(this.props.id),"pollopt")},render:function(){var e=this.state.pollopt;return e.id?i.createElement("div",{className:"PollOption"},i.createElement("div",{className:"PollOption__text"},e.text),i.createElement("div",{className:"PollOption__score"},e.score," point",r(e.score))):l}});t.default=m},172:function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var i,s,a,o,r,l=function l(){var m=Date.now()-o;m<t&&m>0?i=setTimeout(l,t-m):(i=null,n||(r=e.apply(a,s),i||(a=s=null)))},m=function(){a=this,s=arguments,o=Date.now();var m=n&&!i;return i||(i=setTimeout(l,t)),m&&(r=e.apply(a,s),a=s=null),r};return m.cancel=function(){i&&clearTimeout(i)},m}},174:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(27),a=n(46).default,o=n(15).default,r=n(61).default,l=n(103).default,m=n(100).default,d=n(171).default,c=n(22).default,u=n(58).default,h=n(34).default,p=n(33).default;function f(e,t,n){return 1===e?t:e+" "+t+"s"}var C=i.createElement("div",{className:"Item Item--loading"},i.createElement(c,{size:"20"})),g=i.createClass({displayName:"Item",mixins:[u,s],getInitialState:function(){return{item:l.getCachedStory(Number(this.props.params.id))||{}}},componentWillMount:function(){this.bindAsObject(o.itemRef(this.props.params.id),"item"),this.state.item.id&&(this.threadStore=new r(this.state.item,this.handleCommentsChanged,{cached:!0}),p(this.state.item.title)),window.addEventListener("beforeunload",this.handleBeforeUnload)},componentWillUnmount:function(){this.threadStore&&this.threadStore.dispose(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},componentWillReceiveProps:function(e){if(this.props.params.id!==e.params.id){this.threadStore.dispose(),this.threadStore=null,this.unbind("item");var t=l.getCachedStory(Number(e.params.id));t&&(this.threadStore=new r(t,this.handleCommentsChanged,{cached:!0}),p(t.title)),this.bindAsObject(o.itemRef(e.params.id),"item"),this.setState({item:t||{}})}},componentWillUpdate:function(e,t){!this.state.item.id&&t.item.id&&p(t.item.title)},componentDidUpdate:function(e,t){if(t.item.id!==this.state.item.id)this.threadStore&&this.threadStore.itemId===this.state.item.id||(this.threadStore=new r(this.state.item,this.handleCommentsChanged,{cached:!1}),p(this.state.item.title),this.forceUpdate());else if(t.item!==this.state.item){if(this.threadStore.loading){var n=(this.state.item.kids?this.state.item.kids.length:0)-(t.item.kids?t.item.kids.length:0);0!==n&&this.threadStore.adjustExpectedComments(n)}this.threadStore.itemUpdated(this.state.item)}},handleBeforeUnload:function(){this.threadStore&&this.threadStore.dispose()},handleCommentsChanged:function(e){this.forceUpdate()},autoCollapse:function(e){e.preventDefault(),this.threadStore.collapseThreadsWithoutNewComments()},markAsRead:function(e){e.preventDefault(),this.threadStore.markAsRead(),this.forceUpdate()},render:function(){var e=this.state.item,t=this.threadStore;return e.id&&t?i.createElement("div",{className:h("Item",{"Item--dead":e.dead})},i.createElement("div",{className:"Item__content"},this.renderItemTitle(e),this.renderItemMeta(e,null!==t.lastVisit&&t.newCommentCount>0&&i.createElement("span",null," ","(",i.createElement("em",null,t.newCommentCount," new")," in the last ",i.createElement(a,{date:t.lastVisit,formatter:f}),") | ",i.createElement("span",{className:"control",tabIndex:"0",onClick:this.autoCollapse,onKeyPress:this.autoCollapse,title:"Collapse threads without new comments"},"auto collapse")," | ",i.createElement("span",{className:"control",tabIndex:"0",onClick:this.markAsRead,onKeyPress:this.markAsRead},"mark as read"))),e.text&&i.createElement("div",{className:"Item__text"},i.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}})),"poll"===e.type&&i.createElement("div",{className:"Item__poll"},e.parts.map(function(e){return i.createElement(d,{key:e,id:e})}))),e.kids&&i.createElement("div",{className:"Item__kids"},e.kids.map(function(e,n){return i.createElement(m,{key:e,id:e,level:0,loadingSpinner:0===n,threadStore:t})}))):C}});t.default=g},175:function(e,t,n){"use strict";n.r(t);var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=n(137),a=n(0),o=n(136),r=n(174).default;var l=n(167).default,m=n(165).default,d=n(163).default,c=n(160).default,u=n(159).default,h=n(158).default;function p(e,t,n,s){return a.createClass({render:function(){return a.createElement(m,i({},this.props,{key:e,route:e,type:t,limit:n,title:s}))}})}var f,C=p("ask","askstories",200,"Ask"),g=(f="comments",a.createClass({render:function(){return a.createElement(d,i({},this.props,{key:f,type:f}))}})),v=p("jobs","jobstories",200,"Jobs"),E=p("newest","newstories",500,"New Links"),y=p("show","showstories",200,"Show"),S=p("news","topstories",500),w=p("read","read",0,"Read Stories");t.default=a.createElement(o,{path:"/",component:l},a.createElement(s,{component:S}),a.createElement(o,{path:"news",component:S}),a.createElement(o,{path:"newest",component:E}),a.createElement(o,{path:"show",component:y}),a.createElement(o,{path:"ask",component:C}),a.createElement(o,{path:"jobs",component:v}),a.createElement(o,{path:"read",component:w}),a.createElement(o,{path:"item/:id",component:r}),a.createElement(o,{path:"job/:id",component:r}),a.createElement(o,{path:"poll/:id",component:r}),a.createElement(o,{path:"story/:id",component:r}),a.createElement(o,{path:"comment/:id",component:c}),a.createElement(o,{path:"newcomments",component:g}),a.createElement(o,{path:"user/:id",component:u}),a.createElement(o,{path:"*",component:h}))},22:function(e,t,n){"use strict";n.r(t);var i=n(0),s=i.createClass({displayName:"Spinner",getDefaultProps:function(){return{size:6,spacing:2}},render:function(){var e=this.props.size+"px",t={height:e,width:e,marginRight:this.props.spacing+"px"};return i.createElement("div",{className:"Spinner",style:{width:3*(Number(this.props.size)+Number(this.props.spacing))+"px"}},i.createElement("div",{className:"bounce1",style:t}),i.createElement("div",{className:"bounce2",style:t}),i.createElement("div",{className:"bounce3",style:t}))}});t.default=s},258:function(e,t,n){},301:function(e,t,n){"use strict";n.r(t);var i=n(157);n(258),n(130);var s=n(0),a=n(256).render,o=n(149),r=n(183),l=n(132),m=n(175).default;a(s.createElement(o,{history:i.hashHistory,render:l(r()),routes:m}),document.getElementById("app"))},307:function(e,t,n){n(306),e.exports=n(301)},33:function(e,t,n){"use strict";n.r(t);var i=n(42).default.SITE_TITLE;t.default=function(e){"undefined"!=typeof document&&(document.title=e?e+" | "+i:i)}},34:function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=[];void 0===t?t=e:n.push(e);for(var i=Object.keys(t),s=0,a=i.length;s<a;s++)t[i[s]]&&n.push(i[s]);return n.join(" ")}},35:function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){for(var i=Object.keys(t),s=0,a=i.length;s<a;s++)e[i[s]]=t[i[s]];if(n)for(s=0,a=(i=Object.keys(n)).length;s<a;s++)e[i[s]]=n[i[s]];return e}},42:function(e,t,n){"use strict";n.r(t),t.default={ITEMS_PER_PAGE:30,SITE_TITLE:"React HN",UPDATES_CACHE_SIZE:500}},43:function(e,t,n){"use strict";n.r(t);var i=n(101).EventEmitter,s=n(15).default,a=n(42).default.UPDATES_CACHE_SIZE,o=null,r=null,l={};function m(e,t){return t.time-e.time}function d(){l.comments=c(r.comments),l.stories=c(r.stories)}function c(e){var t=function(e){var t=Object.keys(e).map(function(t){return e[t]});return t.sort(m),t}(e);return t.splice(a,Math.max(0,t.length-a)).forEach(function(t){delete e[t.id]}),t}var u={comment:!0,job:!0,poll:!0,story:!0};function h(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];i.deleted||void 0!==u[i.type]&&("comment"===i.type?r.comments[i.id]=i:r.stories[i.id]=i)}d(),p.emit("updates",l)}var p=(0,n(35).default)(new i,{loadSession:function(){var e=window.sessionStorage.updates;r=e?JSON.parse(e):{comments:{},stories:{}},d()},saveSession:function(){window.sessionStorage.updates=JSON.stringify(r)},start:function(){null===o&&(o=s.updatesRef()).on("value",function(e){s.fetchItems(e.val(),h)})},stop:function(){o.off(),o=null},getUpdates:function(){return l},getItem:function(e){return r.comments[e]||r.stories[e]||null},getComment:function(e){return r.comments[e]||null},getStory:function(e){return r.stories[e]||null}});p.off=p.removeListener,t.default=p},44:function(e,t,n){"use strict";n.r(t),function(e){var i=n(101).EventEmitter,s=n(15).default,a=n(35).default,o=/^\d+$/,r=null,l={},m={},d={};function c(e){for(var t=l[e],n=d[e],i=0,s=t.length;i<s;i++)n[i]=m[t[i]]||null}function u(e,t){return e?JSON.parse(e):t}var h=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this));return i.type=e,e in l||(l[e]=[]),e in d||(d[e]=[],c(e)),i.onStorage=i.onStorage.bind(i),i.onStoriesUpdated=i.onStoriesUpdated.bind(i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),n.prototype.getState=function(){return{ids:l[this.type],stories:d[this.type]}},n.prototype.itemUpdated=function(e,t){d[this.type][t]=e,m[e.id]=e},n.prototype.onStorage=function(e){m[e.key]&&this.emit(e.key)},n.prototype.onStoriesUpdated=function(e){l[this.type]=e.val(),c(this.type),this.emit("update",this.getState())},n.prototype.start=function(){var t=this;if("read"===this.type){var n=Object.keys(window.localStorage).filter(function(e){return o.test(e)}).map(function(e){return Number(e)}).sort(function(e,t){return t-e});e(function(){return t.onStoriesUpdated({val:function(){return n}})})}else(r=s.storiesRef(this.type)).on("value",this.onStoriesUpdated);window.addEventListener("storage",this.onStorage)},n.prototype.stop=function(){null!==r&&(r.off(),r=null),window.removeEventListener("storage",this.onStorage)},n}(i);a(h,{getItem:function(e){return m[e]||null},loadSession:function(){l=u(window.sessionStorage.idCache,{}),m=u(window.sessionStorage.itemCache,{})},saveSession:function(){window.sessionStorage.idCache=JSON.stringify(l),window.sessionStorage.itemCache=JSON.stringify(m)}}),t.default=h}.call(this,n(102).setImmediate)},45:function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return(t||",s").split(",")[1===e?0:1]}},58:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(23),a=n(46).default,o=n(9).default,r=n(45).default,l=n(170),m={renderItemMeta:function(e,t){var n=new Date(1e3*e.time);return"job"===e.type?i.createElement("div",{className:"Item__meta"},i.createElement(a,{date:n,className:"Item__time"})):i.createElement("div",{className:"Item__meta"},i.createElement("span",{className:"Item__score"},e.score," point",r(e.score))," ",i.createElement("span",{className:"Item__by"},"by ",i.createElement(s,{to:"/user/"+e.by},e.by))," ",i.createElement(a,{date:n,className:"Item__time"})," | ",i.createElement(s,{to:"/"+e.type+"/"+e.id},e.descendants>0?e.descendants+" comment"+r(e.descendants):"discuss"),t)},renderItemTitle:function(e){var t,n,a,r=!!e.url;return t=e.dead?"[dead] "+e.title:r?i.createElement("a",{href:e.url},e.title):i.createElement(s,{to:"/"+e.type+"/"+e.id},e.title),i.createElement("div",{className:"Item__title",style:{fontSize:o.titleFontSize+"px"}},t,r&&" ",r&&i.createElement("span",{className:"Item__host"},"(",(n=e.url,"www"===(a=l(n,!0).hostname.split(".").slice(-3))[0]&&a.shift(),a.join(".")),")"))}};t.default=m},59:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(23),a=n(46).default,o=n(103).default,r=n(9).default,l=n(22).default,m=n(45).default,d=i.createElement(l,{size:"20"}),c=i.createElement("div",{className:"Comment__text"},"Unable to load comment – this usually indicates the author has configured a delay. Trying again in 30 seconds."),u={fetchAncestors:function(e){var t=this;o.fetchCommentAncestors(e,function(e){t.isMounted()&&t.setState({parent:e.parent,op:e.op})})},renderCommentLoading:function(e){return i.createElement("div",{className:"Comment Comment--loading Comment--level"+this.props.level},(this.props.loadingSpinner||e.delayed)&&d,e.delayed&&c)},renderCommentDeleted:function(e,t){return i.createElement("div",{className:t.className},i.createElement("div",{className:"Comment__content"},i.createElement("div",{className:"Comment__meta"},"[deleted] | ",i.createElement("a",{href:"https://news.ycombinator.com/item?id="+e.id},"view on Hacker News"))))},renderError:function(e,t){return i.createElement("div",{className:t.className},i.createElement("div",{className:"Comment__content"},i.createElement("div",{className:"Comment__meta"},"[error] | comment is ",JSON.stringify(e)," | ",i.createElement("a",{href:"https://news.ycombinator.com/item?id="+t.id},"view on Hacker News"))))},renderCollapseControl:function(e){return i.createElement("span",{className:"Comment__collapse",onClick:this.toggleCollapse,onKeyPress:this.toggleCollapse,tabIndex:"0"},"[",e?"+":"–","]")},renderCommentMeta:function(e,t){return e.dead&&!r.showDead?i.createElement("div",{className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ","[dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+m(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&i.createElement("em",null,t.childCounts.newComments," new"),t.childCounts&&")"):i.createElement("div",{className:"Comment__meta"},t.collapsible&&this.renderCollapseControl(t.collapsed),t.collapsible&&" ",i.createElement(s,{to:"/user/"+e.by,className:"Comment__user"},e.by)," ",i.createElement(a,{date:1e3*e.time}),t.link&&" | ",t.link&&i.createElement(s,{to:"/comment/"+e.id},"link"),t.parent&&" | ",t.parent&&i.createElement(s,{to:"/"+this.state.parent.type+"/"+e.parent},"parent"),t.op&&" | on: ",t.op&&i.createElement(s,{to:"/"+this.state.op.type+"/"+this.state.op.id},this.state.op.title),e.dead&&" | [dead]",t.childCounts&&" | ("+t.childCounts.children+" child"+m(t.childCounts.children,",ren"),t.childCounts&&t.childCounts.newComments>0&&", ",t.childCounts&&t.childCounts.newComments>0&&i.createElement("em",null,t.childCounts.newComments," new"),t.childCounts&&")")},renderCommentText:function(e,t){return i.createElement("div",{className:"Comment__text"},!e.dead||r.showDead?i.createElement("div",{dangerouslySetInnerHTML:{__html:e.text}}):"[dead]",r.replyLinks&&t.replyLink&&!e.dead&&i.createElement("p",null,i.createElement("a",{href:"https://news.ycombinator.com/reply?id="+e.id},"reply")))}};t.default=u},60:function(e,t,n){"use strict";function i(e,t){this.itemId=e.id,this.onCommentsChanged=t,this.children={},this.children[e.id]=[],this.isNew={},this.isCollapsed={}}n.r(t),(0,n(35).default)(i.prototype,{getChildCounts:function(e){for(var t=0,n=0,i=[e.id];i.length;){for(var s=[],a=0,o=i.length;a<o;a++){var r=this.children[i[a]];r.length&&s.push.apply(s,r)}for(a=0,o=s.length;a<o;a++)this.isNew[s[a]]&&n++;t+=s.length,i=s}return{children:t,newComments:n}},commentAdded:function(e){e.deleted||(this.children[e.id]=[],this.children[e.parent].push(e.id))},commentDeleted:function(e){if(e){var t=this.children[e.parent];t.splice(t.indexOf(e.id),1)}},toggleCollapse:function(e){this.isCollapsed[e]=!this.isCollapsed[e],this.onCommentsChanged({type:"collapse"})}}),t.default=i},61:function(e,t,n){"use strict";n.r(t);var i=n(60).default,s=n(9).default,a=n(172).default,o=n(35).default,r=(n(45).default,n(104).default);function l(e){var t=r.get(e);return t?JSON.parse(t):{lastVisit:null,commentCount:0,maxCommentId:0}}function m(e,t,n){i.call(this,e,t),this.startedLoading=Date.now(),this.parents={},this.commentCount=0,this.newCommentCount=0,this.maxCommentId=0,this.loading=!0,this.expectedComments=e.kids?e.kids.length:0,this.itemDescendantCount=e.descendants;var s=l(e.id);this.lastVisit=s.lastVisit,this.prevMaxCommentId=s.maxCommentId,this.isFirstVisit=null===s.lastVisit,n.cached||this.checkLoadCompletion()}m.loadState=l,m.prototype=o(Object.create(i.prototype),{constructor:m,numberOfCommentsChanged:a(function(){this.onCommentsChanged({type:"number"})},123),firstLoadComplete:function(){this.lastVisit=Date.now(),this.prevMaxCommentId=this.maxCommentId,this.isFirstVisit=!1,this.onCommentsChanged({type:"first_load_complete"})},checkLoadCompletion:function(){this.loading&&this.commentCount>=this.expectedComments&&(this.loading=!1,this.isFirstVisit?this.firstLoadComplete():s.autoCollapse&&this.newCommentCount>0&&this.collapseThreadsWithoutNewComments(),this._storeState())},_storeState:function(){r.set(this.itemId,JSON.stringify({lastVisit:Date.now(),commentCount:this.itemDescendantCount,maxCommentId:this.maxCommentId}))},itemUpdated:function(e){this.itemDescendantCount=e.descendants},commentAdded:function(e){e.deleted?this.loading&&(this.expectedComments--,this.checkLoadCompletion()):(i.prototype.commentAdded.call(this,e),e.dead&&!s.showDead?this.expectedComments--:this.commentCount++,this.loading&&e.kids&&(this.expectedComments+=e.kids.length),this.prevMaxCommentId>0&&e.id>this.prevMaxCommentId&&(!e.dead||s.showDead)&&(this.newCommentCount++,this.isNew[e.id]=!0),e.id>this.maxCommentId&&(this.maxCommentId=e.id),e.parent!==this.itemId&&(this.parents[e.id]=e.parent),this.numberOfCommentsChanged(),this.loading&&this.checkLoadCompletion())},commentDelayed:function(e){this.expectedComments--},commentDeleted:function(e){i.prototype.commentDeleted.call(this,e),this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]),delete this.parents[e.id],this.numberOfCommentsChanged()},commentDied:function(e){s.showDead||(this.commentCount--,this.isNew[e.id]&&(this.newCommentCount--,delete this.isNew[e.id]))},adjustExpectedComments:function(e){this.expectedComments+=e,this.checkLoadCompletion()},collapseThreadsWithoutNewComments:function(){for(var e=Object.keys(this.isNew),t={},n=0,i=e.length;n<i;n++)for(var s=this.parents[e[n]];s&&!t[s];)t[s]=!0,s=this.parents[s];for(var a={},o=this.children[this.itemId];o.length;){var r=[];for(n=0,i=o.length;n<i;n++){var l=o[n];if(t[l]){var m=this.children[l];m.length&&r.push.apply(r,m)}else this.isNew[l]||(a[l]=!0)}o=r}this.isCollapsed=a,this.onCommentsChanged({type:"collapse"})},markAsRead:function(){this.lastVisit=Date.now(),this.newCommentCount=0,this.prevMaxCommentId=this.maxCommentId,this.isNew={},this._storeState()},dispose:function(){this.numberOfCommentsChanged.cancel(),this._storeState()}}),t.default=m},9:function(e,t,n){"use strict";n.r(t);var i=n(35).default,s=n(104).default,a={autoCollapse:!0,replyLinks:!0,showDead:!1,showDeleted:!1,titleFontSize:18,listSpacing:16,load:function(){var e=s.get("settings");e&&i(this,JSON.parse(e))},save:function(){s.set("settings",JSON.stringify({autoCollapse:this.autoCollapse,replyLinks:this.replyLinks,showDead:this.showDead,showDeleted:this.showDeleted,titleFontSize:this.titleFontSize,listSpacing:this.listSpacing}))}};t.default=a},96:function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var i=(e-1)*t,s=Math.min(n,i+t);return{pageNum:e,startIndex:i,endIndex:s,hasNext:s<n-1}}},97:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(23),a=n(9).default,o=n(34).default,r={getNewCommentCount:function(e,t){return null===t.lastVisit?0:e.descendants-t.commentCount},renderListItem:function(e,t){if(e.deleted)return null;var n=this.getNewCommentCount(e,t);return i.createElement("li",{className:o("ListItem",{"ListItem--dead":e.dead}),style:{marginBottom:a.listSpacing}},this.renderItemTitle(e),this.renderItemMeta(e,n>0&&i.createElement("span",{className:"ListItem__newcomments"}," ","(",i.createElement(s,{to:"/"+e.type+"/"+e.id},n," new"),")")))}};t.default=r},98:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n(23),a=i.createClass({displayName:"Paginator",_onClick:function(e){setTimeout(function(){window.scrollTo(0,0)},0)},render:function(){return 1!==this.props.page||this.props.hasNext?i.createElement("div",{className:"Paginator"},this.props.page>1&&i.createElement("span",{className:"Paginator__prev"},i.createElement(s,{to:{pathname:"/"+this.props.route,query:{page:this.props.page-1}},onClick:this._onClick},"Prev")),this.props.page>1&&this.props.hasNext&&" | ",this.props.hasNext&&i.createElement("span",{className:"Paginator__next"},i.createElement(s,{to:{pathname:"/"+this.props.route,query:{page:this.props.page+1}},onClick:this._onClick},"More"))):null}});t.default=a},99:function(e,t,n){"use strict";n.r(t);var i={getPageNumber:function(e){return void 0===e&&(e=this.props.location.query.page),e&&/^\d+$/.test(e)?Math.max(1,Number(e)):1}};t.default=i}},[[307,0,1]]]);
//# sourceMappingURL=app.80baceb5.js.map